# XJTU-ICS lab 1: Data Lab æ•°æ®å®éªŒ

## å®éªŒç®€ä»‹

ç›¸ä¿¡å¤§å®¶åœ¨å‰å‡ èŠ‚è¯¾ä¸­å­¦ä¹ ä¸­å·²ç»å­¦åˆ°äº†ä¸å°‘ä¸œè¥¿ï¼Œè¿™ä¸ªå°å®éªŒçš„ç›®çš„æ˜¯è®©å¤§å®¶æ›´åŠ ç†Ÿæ‚‰è®¡ç®—æœºä¸­ä¿¡æ¯è¡¨ç¤ºçš„å¸¸è§æ¨¡å¼å’Œæ•´æ•°çš„ä½çº§è¡¨ç¤ºã€‚ä½ å°†é€šè¿‡è§£å†³ä¸€ç³»åˆ—ç¼–ç¨‹â€œè°œé¢˜â€æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚å…¶ä¸­è®¸å¤šè°œé¢˜å¯èƒ½çœ‹èµ·æ¥æ„é€ çš„éå¸¸åˆ»æ„ï¼ˆhuman-madeï¼‰ï¼Œä½†ä½ ä¼šå‘ç°è‡ªå·±åœ¨å¤„ç†å®ƒä»¬çš„è¿‡ç¨‹ä¸­æ›´å¤šåœ°è€ƒè™‘äº†è®¡ç®—æœºä¸­æ¯”ç‰¹çš„è¡¨ç¤ºæ³•ã€‚

è¿™äº›é¢˜ç›®å¹¶ä¸ç®€å•ï¼Œä½†æ˜¯ç›¸ä¿¡åœ¨å°è¯•æ±‚è§£å®ƒä»¬çš„è¿‡ç¨‹ä¸­ä½ èƒ½æ„Ÿå—åˆ°ä¸€äº›ä¹è¶£ï¼Œå¹¶æå‡ä¸€äº›åŠ¨æ‰‹ä¸ç¼–ç¨‹èƒ½åŠ›ã€‚

Enjoy and Have fun! ğŸ˜‰

## æ³¨æ„äº‹é¡¹

- è¿™æ˜¯ä¸€ä¸ªâ€œä¸ªäººâ€ä½œä¸šï¼Œè¯·ä¸è¦æŠ„è¢­æˆ–è€…å°è¯•å‡ ä¸ªäººä¸€èµ·å®Œæˆ.
- è¿™äº›é—®é¢˜å¹¶ä¸æ˜¯ä¸€äº›å®Œå…¨å…¨æ–°çš„é—®é¢˜ï¼Œæˆ‘ä»¬é¼“åŠ±â€œGoogleâ€å­¦ä¹ è§£å†³ä¸€äº›ä»£ç ä¹‹å¤–çš„é—®é¢˜ï¼ˆç¯å¢ƒé—®é¢˜/å·¥å…·ä½¿ç”¨é—®é¢˜ï¼‰ï¼Œä½†æ˜¯é¢‘ç¹çš„æŸ¥è¯¢ä»£ç è°œé¢˜ç›¸å…³çš„è§£å°†ä½¿å¾—è¿™ä¸ªå®éªŒä¸è¯¾ç¨‹å¤±å»æ„ä¹‰.
- ä¸è¦ä½¿ç”¨è¯¸å¦‚deepseekï¼Œchatgptç­‰å¤§æ¨¡å‹çš„å¸®åŠ©ï¼Œå½“ç„¶ä½ ç”¨äº†æˆ‘ä»¬å¯èƒ½æŸ¥ä¸å‡ºæ¥ï¼Œä½†æ˜¯å»ºè®®è‡ªå·±åŠ¨è„‘å­å®Œæˆè¿™äº›é¢˜ç›®ï¼Œç°åœ¨èŠ±æ—¶é—´äº†æœŸæœ«è€ƒè¯•å¤ä¹ å°±ç®€å•äº† ğŸ˜

## å¼€å‘ç¯å¢ƒå’Œå®éªŒå‰å‡†å¤‡

å‰ç½®è¦æ±‚ï¼š å­¦ä¹ å®Œ[lab0: ç¯å¢ƒæ­å»º](http://ics.xjtu-ants.net/labs/lab0/)ï¼Œç¡®ä¿è‡ªå·±æ‰‹è¾¹æœ‰å¯ç”¨çš„linuxç¯å¢ƒå’Œå®Œæ•´çš„å¼€å‘å·¥å…·é“¾(gcc, makeç­‰)ï¼Œ**ä¸è¦è¯•å›¾åœ¨windowsç¯å¢ƒä¸‹å®Œæˆå®éªŒ**ã€‚

### è¿œç¨‹å¼€å‘

å¦‚æœä½ æ‰‹è¾¹æ²¡æœ‰Linuxç¯å¢ƒï¼Œä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸€ä¸ªåŒå­¦å‡†å¤‡äº†æœåŠ¡å™¨è´¦å·ã€‚

ä¸çŸ¥é“æ€ä¹ˆä½¿ç”¨æœåŠ¡å™¨çš„åŒå­¦ï¼Œè¯·ç§»æ­¥[ICS Server](http://ics.xjtu-ants.net/resources/ICS-Server/)å­¦ä¹ å®Œæ•´æµç¨‹ï¼Œå¹¶ä¸”**ç¡®ä¿ä½ å¯ä»¥ç™»é™†ä¸ŠICSæœåŠ¡å™¨**

åœ¨æœåŠ¡å™¨ä¸Šå¼€å‘æ–¹å¼é€‰æ‹©ï¼š

- ï¼ˆæ¨èï¼‰ä½¿ç”¨vscodeè¿›è¡Œè¿œç¨‹è¿æ¥ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹æ•™ç¨‹[Vscode sshé…ç½®](http://ics.xjtu-ants.net/resources/VScodeRemote-SSH/)
- ï¼ˆèƒ½åŠ›å¼ºçš„åŒå­¦å¯ä»¥å°è¯•ï¼ŒåŒæ—¶å¯ä»¥å‘åŠ©æ•™åˆ†äº«ä½ çš„é…ç½® ğŸ¥³ï¼‰ä½¿ç”¨tmux + ssh + vim/nvim/emacsç­‰å·¥å…·è¿›è¡Œå¼€å‘ã€‚

ç™»é™†æˆåŠŸä¹‹åï¼Œåœ¨è‡ªå·±çš„å®¶ç›®å½•ä¸‹ï¼ˆ`/home/username`ï¼‰ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°ä¸€ä¸ªåä¸º`datalab-sp25`çš„ç›®å½•ï¼š

å¦‚æœä½ ç¼ºå°‘è¿™ä¸ªç›®å½•ï¼Œæœ‰ä¸‰ç§è§£å†³æ–¹å¼ï¼š

- åœ¨è¯¾ç¨‹ç½‘ç«™ä¸Šä¸‹è½½[datalab-sp25.tar](https://xjtu-ics.github.io/assets/files/datalab-sp25.tar)ï¼Œç„¶åé€šè¿‡å‘½ä»¤`tar xvf datalab-sp25`è§£å‹
- è¿›å…¥æœ¬æ¬¡å®éªŒçš„[å…¬æœ‰ä»“åº“](https://github.com/xjtu-ics/datalab-sp25)ï¼Œä½¿ç”¨`git clone`å…‹éš†ä»“åº“åˆ°æœ¬åœ°ï¼ˆæ¨èï¼‰
- å¯»æ‰¾åŠ©æ•™è¿›è¡Œè§£å†³

å½“ç„¶ï¼ŒåŠ©æ•™ä»¬å¸Œæœ›åŒå­¦ä»¬è¿˜æ˜¯å°½é‡å¯ä»¥è‡ªå·±è§£å†³ï¼Œæ¯•ç«Ÿä¸€æ–¹é¢åŠ©æ•™ä»¬å¹³æ—¶éƒ½å¾ˆå¿™ï¼Œå¦ä¸€æ–¹é¢è‡ªå·±åŠ¨æ‰‹æŸ¥é˜…èµ„æ–™ï¼Œè§£å†³é—®é¢˜ä¹Ÿå¯ä»¥åŸ¹å…»è‡ªå·±è¿™æ–¹é¢çš„èƒ½åŠ›ï¼Œè¿™ä¹Ÿæ˜¯è¿™é—¨è¯¾å¼€è®¾çš„åˆè¡·ã€‚ ğŸ’ª

### æœ¬åœ°å¼€å‘

ä¹Ÿå¯ä»¥è‡ªå·±æ­å»ºå¼€å‘ç¯å¢ƒï¼Œç¯å¢ƒè¦æ±‚ä¸ºï¼š

- Linux æˆ– WSL (æ¨è Ubuntu 22.04 / Arch Linux)
- gcc-11
- GNU Make

> ä¸Šè¿°å·¥å…·ç‰ˆæœ¬ä»…ä¾›å‚è€ƒï¼Œä½¿ç”¨æ›´é«˜ç‰ˆæœ¬çš„å·¥å…·é“¾åªè¦ä¸æŠ¥é”™å°±å¯ä»¥ã€‚

æœ‰å…³æœ¬åœ°ç¯å¢ƒçš„æ­å»ºæŒ‡å¯¼ï¼Œè¯·ç§»æ­¥[Linux Installation](http://ics.xjtu-ants.net/resources/LinuxInstallation/)

è‡ªå·±æœ¬åœ°å¼€å‘çš„å®éªŒèµ„æºè·å–æ–¹å¼ï¼š

- ä¸‹è½½æ–‡ä»¶[datalab-sp25.tar](https://xjtu-ics.github.io/assets/files/datalab-sp25.tar)ï¼Œç„¶åé€šè¿‡å‘½ä»¤`tar xvf datalab-sp25.tar`è¿›è¡Œè§£å‹
- è¿›å…¥æœ¬æ¬¡å®éªŒçš„[å…¬æœ‰ä»“åº“](https://github.com/xjtu-ics/datalab-sp25)ï¼Œä½¿ç”¨`git clone`å…‹éš†ä»“åº“åˆ°æœ¬åœ°ï¼ˆæ¨èï¼‰
- æ‰¾åŒå­¦/åŠ©æ•™å‘ç»™ä½ 

å¦‚æœä½ å·²ç»é¡ºåˆ©çš„åœ¨æœ¬åœ°å®‰è£…æˆ–è€…ç”³è¯·åˆ°äº†ä¸€ä¸ªç¨³å®šçš„Linuxç¯å¢ƒï¼Œå¹¶ä¸”å‡†å¤‡å¥½äº†å®éªŒç›¸å…³ç›®å½•ï¼Œé‚£ä¹ˆå°±å¯ä»¥é¡ºåˆ©çš„å¼€å§‹ä½ çš„å®éªŒ~

### ä½¿ç”¨è‡ªå·±çš„è¿œç¨‹ä»“åº“è¿›è¡Œå¤‡ä»½ï¼ˆé€‰åšï¼‰

ä¸ç®¡ä½ ä½¿ç”¨ä»€ä¹ˆæ–¹å¼è·å–å®éªŒèµ„æºï¼Œæˆ‘ä»¬éƒ½**å»ºè®®è‡ªå·±ä½¿ç”¨ä¸€ä¸ªè¿œç¨‹ä»“åº“è¿›è¡Œå¤‡ä»½**ï¼Œä»¥é˜²æœåŠ¡å™¨æˆ–è€…æœ¬åœ°ç¯å¢ƒå‡ºç°æ— æ³•æ¢å¤çš„é”™è¯¯ã€‚

ä½¿ç”¨ICS Serverçš„åŒå­¦ï¼Œæˆ‘ä»¬å·²ç»åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…äº†gitï¼Œæœ¬åœ°å¼€å‘çš„åŒå­¦è¯·è‡ªå·±æ£€æŸ¥æ˜¯å¦å®‰è£…äº†gitï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ï¼š

```bash
git --version
```

> å¦‚æœéœ€è¦é€šè¿‡sshä½¿ç”¨github, é¦–å…ˆåœ¨æœ¬åœ°ç”Ÿæˆsshå¯†é’¥å¯¹ï¼Œç„¶åå°†å…¬é’¥æ·»åŠ åˆ°è‡ªå·±çš„githubè´¦æˆ·ä¸­ã€‚

å¦‚æœä½ ä½¿ç”¨æœåŠ¡å™¨æˆ–è€…é€šè¿‡ä¸‹è½½å‹ç¼©åŒ…çš„æ–¹å¼ï¼Œé‚£ä¹ˆä½ éœ€è¦é¦–å…ˆå»ºç«‹ä¸€ä¸ªæœ¬åœ°ä»“åº“ï¼Œåˆ‡æ¢åˆ°`datalab-sp25`ç›®å½•ï¼Œç„¶åè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š

```bash
git init
```

è¿™ä¼šåœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹é¢å»ºç«‹ä¸€ä¸ª`.git`ç›®å½•ï¼Œå­˜æ”¾ä½ çš„æœ¬åœ°ä»“åº“çš„ä¸€äº›ä¿¡æ¯ã€‚

ä¹‹åä½ å¯ä»¥å°†æˆ‘ä»¬çš„å…¬å¼€ä»“åº“å’Œè‡ªå·±çš„æœ¬åœ°ä»“åº“å…³è”ï¼š

```bash
git remote add upstream git@github.com:xjtu-ics/datalab-sp25.git
```

è¿™é‡Œæˆ‘ä»¬å»ºè®®ä½ å°†å…¬æœ‰ä»“åº“çš„åå­—å‘½åä¸º`upstream`ï¼Œå› ä¸ºé€šå¸¸ä»£è¡¨äº†**ä¸Šæ¸¸ä»“åº“**ï¼Œåœ¨å¤šäººååŒå¼€å‘ä¸­ï¼Œè¿™ç§ä»“åº“é€šå¸¸ç”¨äºåŒæ­¥æœ¬åœ°ä¿¡æ¯ï¼Œ**å³å¯ä»¥pullï¼Œä½†æ˜¯æ²¡æœ‰pushæƒé™**çš„ä»“åº“ã€‚

å¯¹äºè‡ªå·±å»ºç«‹çš„ä»“åº“ï¼Œä¸€èˆ¬éœ€è¦è‡ªå·±å†™ä¸€ä¸ª`.gitignore`æ–‡ä»¶ï¼Œä»¥å±è”½é¡¹ç›®ä½¿ç”¨çš„ä¸€äº›ä¸´æ—¶æ–‡ä»¶ï¼Œå¯¹äºè¿™ä¸ªå®éªŒï¼Œä¸€ä¸ªå‚è€ƒçš„`.gitignore`æ–‡ä»¶å¦‚ä¸‹ï¼š

```text
*.o
*~
ishow
fshow
btest
```

å¦‚æœä½ æ˜¯ç›´æ¥ä½¿ç”¨`git clone`çš„æ–¹å¼ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```bash
git clone -o upstream git@github.com:xjtu-ics/datalab-sp25.git
```

è¿™ä¼šå°†æœ¬åœ°ä»“åº“è‡ªåŠ¨å°†ä¸Šæ¸¸ä»“åº“è¿›è¡Œå…³è”ï¼Œå¹¶ä¸”è®¾ç½®ä¸Šæ¸¸ä»“åº“åä¸º`upstream`

è¿™ä¹ˆåšçš„å¥½å¤„æ˜¯ï¼Œå¦‚æœåŠ©æ•™ä»¬æˆ–è€…è€å¸ˆä¿®æ”¹äº†ä¸Šæ¸¸ä»“åº“çš„å†…å®¹ï¼ˆæ¯”å¦‚readmeæˆ–è€…æµ‹è¯•æ–‡ä»¶ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è¿›è¡ŒåŒæ­¥ï¼š

```bash
git pull upstream main
```

ä¹‹åï¼Œä½ å¯ä»¥å†å…³è”ä¸€ä¸ªè‡ªå·±çš„è¿œç¨‹ä»“åº“è¿›è¡Œå¤‡ä»½ï¼Œä½†æ˜¯**è¯·åŠ¡å¿…ç¡®ä¿ä½ çš„ä»“åº“ä¸€å®šæ˜¯ç§æœ‰çš„**ï¼ŒåŒæ—¶ä¹Ÿä¸è¦è¯•å›¾åœ¨githubç­‰ç½‘ç«™ä¸Šæœç´¢å­¦é•¿çš„ä»£ç ï¼Œå› ä¸º**æ¯å¹´é¢˜ç›®éƒ½ä¸ä¸€æ ·**ã€‚

é¦–å…ˆï¼Œä½ éœ€è¦å»ºç«‹ä¸€ä¸ªè¿œç¨‹çš„ç§æœ‰ä»“åº“ï¼Œå¯ä»¥ä½¿ç”¨githubæˆ–å…¶ä»–ç±»ä¼¼ç½‘ç«™ï¼Œç„¶åè®°å½•ä¸‹è‡ªå·±ä»“åº“çš„urlã€‚

ç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ·»åŠ è¿œç¨‹ä»“åº“ï¼š

```bash
git remote add origin git@github.com:your_username/your_repo.git
```

å°†ä¸Šè¿°urlä¸­çš„`your_username`å’Œ`your_repo`æ›¿æ¢æˆè‡ªå·±çš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè‡ªå·±çš„è¿œç¨‹ä»“åº“é€šå¸¸å‘½åä¸ºoriginã€‚

æ·»åŠ æˆåŠŸä¹‹åï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹ç°æœ‰çš„ä»“åº“åˆ—è¡¨ï¼š

```bash
git remote -v
```

ä½ åº”è¯¥å¯ä»¥çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹åˆ—è¡¨ï¼š

```text
origin	git@github.com:Scorpicathe/mydatalab.git (fetch)
origin	git@github.com:Scorpicathe/mydatalab.git (push)
upstream	git@github.com:xjtu-ics/datalab-sp25.git (fetch)
upstream	git@github.com:xjtu-ics/datalab-sp25.git (push)
```

ç°åœ¨å’Œä½ æœ¬åœ°ä»“åº“å…³è”çš„æœ‰ä¸¤ä¸ªè¿œç¨‹ä»“åº“ï¼Œä¸€ä¸ªæ˜¯ä¸Šæ¸¸ä»“åº“ï¼Œä¸€ä¸ªæ˜¯ä½ è‡ªå·±çš„è¿œç¨‹ä»“åº“ã€‚

é‚£ä¹ˆæ¯æ¬¡ä½ å®Œæˆä¸€éƒ¨åˆ†å®éªŒä¹‹åï¼Œå¯ä»¥ä½¿ç”¨`git add`å’Œ`git commit`å°†æ›´æ”¹æäº¤åˆ°æœ¬åœ°ä»“åº“ã€‚

ç„¶åå°†æœ¬åœ°çš„æäº¤pushåˆ°è¿œç¨‹ï¼š

```bash
git push -u origin main
```

è¿™æ ·ä½ è‡ªå·±çš„è¿œç¨‹ä»“åº“åŒ…å«äº†å®éªŒå·²å®Œæˆçš„éƒ¨åˆ†ï¼Œå³ä½¿æœåŠ¡å™¨æˆ–è€…è‡ªå·±çš„æœ¬åœ°ç¯å¢ƒå‡ºç°é”™è¯¯æ— æ³•æ¢å¤æ—¶ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥ä»è‡ªå·±çš„ä»“åº“è¿›è¡Œcloneï¼Œå®ç°äº†ä¸€ä¸ªå¤‡ä»½çš„åŠŸèƒ½ã€‚

å½“ç„¶ï¼Œæ¯æ¬¡pushä¹‹å‰å»ºè®®å…ˆä»ä¸Šæ¸¸ä»“åº“pullä¸€ä¸‹ï¼Œæ¥åŒæ­¥ä¸€ä¸‹è‡ªå·±æœ¬åœ°ä»“åº“çš„å†…å®¹ï¼š

```bash
git pull upstream main
```

### å®éªŒç¯å¢ƒæµ‹è¯•æµç¨‹

ä¸€ä¸ªæ¯”è¾ƒæ¨èçš„å®éªŒç¯å¢ƒæµ‹è¯•æµç¨‹å¦‚ä¸‹ï¼š

#### æ£€æŸ¥æ–‡ä»¶å®Œæ•´æ€§

è§£å‹å®Œæˆåä½ å°†è·å¾—å¦‚ä¸‹çš„ä¸€ä¸ªå®Œæ•´ç›®å½•ï¼Œè¯·æ£€æŸ¥ä½ ä¸‹è½½å¹¶è§£å‹çš„æ–‡ä»¶ä¸­æ˜¯å¦åŒ…å«å¦‚ä¸‹ç›®å½•ï¼š

```bash
linux$ ls
bits.c  bits.h  btest.c  btest.h  decl.c  dlc  Driverlib.pm  driver.pl  fshow.c  ishow.c  Makefile  README.md  tests.c
```

> å¦‚å‡ºç°æ–‡ä»¶å®Œæ•´æ€§é—®é¢˜è¯·åŠæ—¶è¯¢é—®åŒå­¦æˆ–è€…æ‰¾åŠ©æ•™è§£å†³ç›¸å…³é—®é¢˜ã€‚

#### å°è¯•`make`

`Makefile` æ–‡ä»¶æè¿°äº† `Linux` ç³»ç»Ÿä¸‹ `C/C++` å·¥ç¨‹çš„ç¼–è¯‘è§„åˆ™ï¼Œå®ƒç”¨æ¥è‡ªåŠ¨åŒ–ç¼–è¯‘ `C/C++` é¡¹ç›®ã€‚åˆ†å‘ä¸‹å»çš„å®éªŒåŒ…å†…å·²ç»æœ‰ç¼–å†™å¥½çš„`Makefile` ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æœ¬æœºä¸­å°è¯•`make`ï¼Œå°±å¯ä»¥è·å¾—ä¸€äº› `Linux` ä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚

ï¼ˆæƒ³è¦ä»”ç»†äº†è§£`Makefile`ç›¸å…³ä¿¡æ¯ï¼š

[What is a Makefile and how does it work?](https://opensource.com/article/18/8/what-how-makefile)

[Tutorial on writing makefiles](https://www.math.colostate.edu/~yzhou/computer/writemakefile.html))

`make`æ–¹æ³•ï¼šåœ¨å¯¹åº”è·¯å¾„ä¸‹åœ¨å‘½ä»¤è¡Œè¾“å…¥`make`ï¼Œå›è½¦.

```bash
linux$ make
```

å¦‚æœ`make`æˆåŠŸï¼Œä¸€ä¸ªå…¸å‹çš„è¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š

```bash
linux$ make                                                                                   
gcc -O -Wall -m32 -lm -o btest bits.c btest.c decl.c tests.c
gcc -O -Wall -m32 -o fshow fshow.c
gcc -O -Wall -m32 -o ishow ishow.c
```

> åœ¨makeçš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡ºç°ä¸€äº›warningï¼Œå‡å±äºæ­£å¸¸ç°è±¡~

#### å‡ºé”™å¤„ç†

ä¸€äº›å¯èƒ½å‡ºç°çš„å…¸å‹ç¯å¢ƒé—®é¢˜å’Œè§£å†³æ–¹æ³•å°†åœ¨é™„å½•ä¸­åšç®€è¦è§£é‡Šï¼Œä¸€ä¸ªæ¯”è¾ƒæ¨èçš„é€šç”¨çš„é—®é¢˜è§£å†³æ–¹æ³•çš„è·¯å¾„æ˜¯ï¼š

- æŸ¥çœ‹æŠ¥é”™ï¼Œæ ¹æ®æŠ¥é”™åˆ†æäº§ç”ŸåŸå› 
- ç›´æ¥å’¨è¯¢Googleæˆ–è€…ChatGPT, DeepSeekç­‰
- è‹¥æ— æ³•æˆåŠŸè§£å†³åˆ™å’¨è¯¢åŠ©æ•™æˆ–ç™»å½•[Piazza](https://piazza.com/stu.xjtu.edu.cn/spring2025/xjtuics)è¯¢é—®

#### å°è¯•è¿è¡Œ

å¦‚æœæˆåŠŸ`make`æ­¤æ—¶ä½ çš„å®éªŒç›®å½•å°†ä¼šå˜æˆå¦‚ä¸‹ï¼š

```bash
linux$ ls
bits.c  bits.h  btest  btest.c  btest.h  decl.c  dlc  Driverhdrs.pm  Driverlib.pm  driver.pl  fshow  fshow.c  ishow  ishow.c  Makefile  README.md  tests.c  xxxxxx-handin.zip
```

ç®€å•éªŒè¯å¯ç”¨æ€§ï¼Œæˆ‘ä»¬ç®€å•è¿è¡Œä¸€ä¸‹`make`ä¹‹åè·å¾—å¯æ‰§è¡Œæ–‡ä»¶`btest`

è¿è¡Œæ–¹æ³•ï¼šå‘½ä»¤è¡Œè¾“å…¥

```bash
linux$ ./btest
```

æ­¤æ—¶è‹¥è¿è¡ŒæˆåŠŸï¼Œåˆ™ä¼šå‡ºç°ï¼š

```bash
linux$ ./btest  
Score	Rating	Errors	Function
ERROR: Test isZero(-2147483648[0x80000000]) failed...
...Gives 2[0x2]. Should be 0[0x0]
ERROR: Test bitXor(-2147483648[0x80000000],-2147483648[0x80000000]) failed...
...Gives 2[0x2]. Should be 0[0x0]
ERROR: Test copyLSB(-2147483648[0x80000000]) failed...
...Gives 2[0x2]. Should be 0[0x0]
ERROR: Test isNegative(-2147483648[0x80000000]) failed...
...Gives 2[0x2]. Should be 1[0x1]
ERROR: Test allEvenBits(-2147483648[0x80000000]) failed...
...Gives 2[0x2]. Should be 0[0x0]
ERROR: Test byteSwap(-2147483648[0x80000000],0[0x0],0[0x0]) failed...
...Gives 2[0x2]. Should be -2147483648[0x80000000]
ERROR: Test removeRightmostOne(-2147483648[0x80000000]) failed...
...Gives 2[0x2]. Should be 0[0x0]
ERROR: Test maskBelowHighest(-2147483648[0x80000000]) failed...
...Gives 2[0x2]. Should be -1[0xffffffff]
ERROR: Test largerAbsVal(-2147483647[0x80000001],-2147483648[0x80000000]) failed...
...Gives 2[0x2]. Should be -2147483648[0x80000000]
ERROR: Test bitReverse(-2147483648[0x80000000]) failed...
...Gives 2[0x2]. Should be 1[0x1]
Total points: 0/80
```

å‡ºç°å¦‚ä¸Šæˆ–ç±»ä¼¼å¦‚ä¸Šçš„è¾“å‡ºç»“æœï¼Œæ­å–œä½ ï¼è¿™è¯æ˜æ‚¨çš„æœ¬åœ°ç¯å¢ƒå·²ç»å‡†å¤‡å¥½äº†ï¼Œä¹‹åå°±å¯ä»¥å¿«ä¹çš„å¼€å§‹Codingã€‚

## å®éªŒä»»åŠ¡

å®éªŒå‡†å¤‡ä¸­ï¼Œæˆ‘ä»¬åœ¨å®éªŒè·¯å¾„çœ‹åˆ°éå¸¸å¤šçš„æ–‡ä»¶ï¼Œä½ æ˜¯å¦æ„Ÿåˆ°äº†ä¸€ä¸æ…Œå¼ ï¼Ÿåˆ«æ…Œï¼å¤§å¤šæ•°çš„ä¸œè¥¿éƒ½æ˜¯æ¥å¸®åŠ©ä½ æ›´å¥½çš„å®Œæˆä½ çš„å®éªŒï¼Œä½ æœ¬åœ°ä¸­å”¯ä¸€éœ€è¦**æ›´æ”¹ä¸æäº¤çš„ä»£ç æ–‡ä»¶**å°±æ˜¯**bits.c**(This is all you need.)ã€‚æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œé‡‡ç”¨ä½ å¿ƒä»ªçš„ç¼–è¾‘å™¨ï¼Œå¼€å§‹è¿™ä¸ªå®éªŒå§ï¼

äº‹å®ä¸Šï¼Œåœ¨`bits.c`ä¸­å·²ç»è¯¦ç»†è¯´æ˜äº†å®éªŒçš„æ­¥éª¤ï¼Œä»¥åŠå„ç§ä»£ç çš„è§„åˆ™ï¼Œè¯·å¤§å®¶ä»”ç»†é˜…è¯»`bits.c`çš„é¡¶éƒ¨æ³¨é‡Šéƒ¨åˆ†ï¼š

```c
/* 
 * CS:APP Data Lab 
 * 
 * <Please put your name and userid here>
 * 
 * bits.c - Source file with your solutions to the Lab.
 *          This is the file you will hand in to your instructor.
 *
 * WARNING: Do not include the <stdio.h> header; it confuses the dlc
 * compiler. You can still use printf for debugging without including
 * <stdio.h>, although you might get a compiler warning. In general,
 * it's not good practice to ignore compiler warnings, but in this
 * case it's OK.  
 */

#if 0
/*
 * Instructions to Students:
 *
 * STEP 1: Read the following instructions carefully.
 */

You will provide your solution to the Data Lab by
editing the collection of functions in this source file.

INTEGER CODING RULES:

....
....
....

#endif

```

`#if 0`ä¸`#endif`ä¸­çš„æ³¨é‡Šéƒ¨åˆ†å·²ç»æŠŠè¿™ä¸ªå®éªŒè¦åšä»€ä¹ˆä»¥åŠæ€ä¹ˆåšå†™çš„å¾ˆæ¸…æ¥šäº†ï¼Œè¿™é‡Œåªåšä¸€ä¸‹æ€»ç»“ã€‚

### ç¬¬ä¸€æ­¥ï¼šä»”ç»†é˜…è¯»ä»¥ä¸‹å®éªŒè¦æ±‚ä»¥åŠä»£ç è§„åˆ™

ä½ çš„ä»»åŠ¡æ˜¯é€šè¿‡ä¿®æ”¹`bits.c`æ–‡ä»¶ä¸­çš„å‡½æ•°ï¼Œæ¥æäº¤ä½ çš„å®éªŒç»“æœã€‚

#### ä»£ç è§„åˆ™ï¼š

`bits.c`æ–‡ä»¶åŒ…å«äº†é’ˆå¯¹10ä¸ªç¼–ç¨‹è°œé¢˜çš„åŸºæœ¬æ¡†æ¶ã€‚åœ¨è¿™ä¸ªå®éªŒä¸­ä½ çš„ä»»åŠ¡å°±æ˜¯åœ¨ä¸€ä¸ªä¸¥æ ¼çš„Coding Rulesï¼ˆä»£ç ç¼–å†™è§„åˆ™ï¼‰ä¹‹ä¸‹å®Œæˆæ¯ä¸ªå‡½æ•°ç¼–å†™ï¼ˆä¸€ä¸ªå‡½æ•°å°±ä»£è¡¨ä¸€ä¸ªå°è°œé¢˜ï¼‰ï¼Œå³ç”¨ä¸€è¡Œæˆ–å¤šè¡ŒCä»£ç æ›¿æ¢æ¯ä¸ªå‡½æ•°ä¸­çš„â€œreturnâ€è¯­å¥ï¼Œä»¥å®ç°è¯¥å‡½æ•°ï¼Œè¿™ä¸ªä¸¥æ ¼çš„ä»£ç ä»£ç ç¼–å†™è§„åˆ™å¦‚ä¸‹ï¼š

å‡è®¾ä½ å†™çš„å‡½æ•°æ ¼å¼å¦‚ä¸‹ï¼š
```c
int Funct(arg1, arg2, ...) {
    /* brief description of how your implementation works */
    int var1 = Expr1;
    ...
    int varM = ExprM;

    varJ = ExprJ;
    ...
    varN = ExprN;
    return ExprR;
}
```
æ¯ä¸ª"expr"**åªèƒ½åŒ…å«**ä»¥ä¸‹è¿™äº›ï¼š

- æ•´æ•°å¸¸é‡`0`åˆ°`255`ï¼ˆ`0xFF`ï¼‰ï¼Œä¸å…è®¸ä½¿ç”¨å¤§çš„å¸¸é‡å¦‚`0xffffffff`ã€‚
- å‡½æ•°å‚æ•°å’Œå±€éƒ¨å˜é‡ï¼ˆä¸å…è®¸ä½¿ç”¨å…¨å±€å˜é‡ï¼‰ã€‚
- ä¸€å…ƒæ•´æ•°æ“ä½œç¬¦ `! ~`
- äºŒå…ƒæ•´æ•°æ“ä½œç¬¦ `& ^ | + << >>`

> åŒæ—¶ä¸€äº›ç¼–ç¨‹è°œé¢˜ï¼ˆå‡½æ•°ï¼‰è¿›ä¸€æ­¥é™åˆ¶äº†è¿ç®—ç¬¦çš„ä¸ªæ•°ï¼Œè¯¦ç»†çš„è§„åˆ™åœ¨`bits.c`ä¸­æ¯ä¸ªå‡½æ•°ä¸Šæ–¹çš„æ³¨é‡Šä¸­æœ‰æ˜ç¡®çš„è¯´æ˜ï¼Œ**æ³¨æ„ï¼Œå¦‚æœä¸æŒ‰ç…§è¿ç®—ç¬¦ä¸ªæ•°å®ç°ä»£ç æ˜¯è¦æ‰£åˆ†çš„å“¦(å…³äºè¯„åˆ†ç»†åˆ™åœ¨åé¢è¯„åˆ†ä¸­æœ‰æ˜ç¡®è¯´æ˜)**ã€‚

**æ˜ç¡®ç¦æ­¢ä½¿ç”¨çš„æ“ä½œåŒ…æ‹¬ï¼š**

- æ§åˆ¶ç»“æ„å¦‚`if, do, while, for, switch`ç­‰ã€‚
- ä½¿ç”¨å®å®šä¹‰ã€‚ä¾‹å¦‚`#define AND(a, b) ((a) & (b))`æ˜¯ä¸å…è®¸çš„ã€‚
- åœ¨æ­¤æ–‡ä»¶ä¸­å®šä¹‰ä»»ä½•é¢å¤–çš„å‡½æ•°ã€‚
- è°ƒç”¨ä»»ä½•å‡½æ•°ã€‚ï¼ˆæˆ‘ä»¬åœ¨`bits.c`ä¸­åŒ…å«äº†`printf`ä»¥ä¾›å¤§å®¶`debug`ä½¿ç”¨ï¼Œå…¶ä½™åªå…è®¸ä½¿ç”¨`C`è¯­è¨€åŸºç¡€çš„è¿ç®—ç¬¦è¿›è¡Œæ±‚è§£ï¼Œæœ€ç»ˆæäº¤çš„ä»£ç è¯·ä¸è¦åŒ…å«`printf`ï¼‰
- ä½¿ç”¨å…¶ä»–æ“ä½œç¬¦ï¼Œå¦‚`&&, ||, -, ?, :`ï¼Œæ¯ä¸ªè°œé¢˜çš„ä¸Šæ–¹æ³¨é‡Šå¤„éƒ½æœ‰æ˜ç¡®çš„åˆæ³•æ“ä½œç¬¦ç§ç±»ï¼ˆLegal Opsï¼‰ã€‚
- ä½¿ç”¨ä»»ä½•å½¢å¼çš„ç±»å‹è½¬æ¢ã€‚
- ä½¿ç”¨é™¤`int`ä¹‹å¤–çš„ä»»ä½•æ•°æ®ç±»å‹ï¼ŒåŒæ—¶ä½ ä¸èƒ½ä½¿ç”¨æ•°ç»„ã€`struct`æˆ–`union`ã€‚
- ä¸å…è®¸ä½¿ç”¨`include`æ·»åŠ æ–°çš„åº“ã€‚

#### å¯ä»¥ç¡®å®šçš„å‡è®¾ï¼š

åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œä½ å¯ä»¥å»ºç«‹å¦‚ä¸‹å‡è®¾ï¼š

- æ•°æ®ç±»å‹`int`çš„å€¼ä¸º`32`ä½ã€‚
- å¸¦ç¬¦å·æ•°æ®çš„å³ç§»ä»¥ç®—æœ¯å³ç§»æ–¹å¼æ‰§è¡Œã€‚
- å¯¹äº`int`æ•°æ®ç±»å‹ï¼Œå¦‚æœç§»ä½é‡å°äº`0`æˆ–å¤§äº`31`æ—¶ï¼Œè¡Œä¸ºä¸å¯é¢„æµ‹ï¼Œä¹Ÿå°±æ˜¯è¯´å½“ç§»ä½è¿ç®—æ—¶ï¼Œç§»åŠ¨é‡åº”è¯¥åœ¨`0` å’Œ `31` ä¹‹é—´ã€‚

#### æ³¨æ„äº‹é¡¹ï¼š

- å¯ä»¥ä½¿ç”¨`dlc`ï¼ˆ`datalab checker`ï¼‰ç¼–è¯‘å™¨æ¥æ£€æŸ¥ä½ çš„ç­”æ¡ˆæ˜¯å¦ç¬¦åˆä»£ç è§„åˆ™ã€‚å¦‚æœä¸ç¬¦åˆä»£ç è§„åˆ™ï¼Œå³ä½¿å¯ä»¥å®ç°å¯¹åº”çš„åŠŸèƒ½ï¼Œä¹Ÿä¸ä¼šå¾—åˆ†ã€‚

- æ¯ä¸ªå‡½æ•°éƒ½æœ‰æœ€å¤§æ“ä½œç¬¦æ•°é‡(`Max Ops`)ï¼Œç”±`dlc`æ£€æŸ¥ï¼Œå¦‚æœè¶…è¿‡ä½¿ç”¨çš„æœ€å¤§æ“ä½œç¬¦æ•°é‡ï¼Œæ˜¯å¯ä»¥å…è®¸çš„ï¼Œä½†æ˜¯è¦æ‰£é™¤ä¸€éƒ¨åˆ†åˆ†æ•°ï¼ˆå…·ä½“åœ¨å¾—åˆ†ä¸­è¯´æ˜ï¼‰ã€‚

- ä½¿ç”¨`btest`æµ‹è¯•å·¥å…·æ¥æ£€æŸ¥ä½ å†™çš„å‡½æ•°çš„æ­£ç¡®æ€§ã€‚

- ä½¿ç”¨`driver.pl`æ­£å¼éªŒè¯ä½ çš„å‡½æ•°ã€‚

> ç”±äºdlcçš„ä¸€äº›å®ç°ç»†èŠ‚æ‰€é™ï¼Œå¤§å®¶å¦‚æœéœ€è¦å£°æ˜å±€éƒ¨å˜é‡ï¼Œè¯·åŠ¡å¿…å°†æ‰€æœ‰å±€éƒ¨å˜é‡çš„å£°æ˜è¯­å¥æ”¾åœ¨ä»£ç å—å¼€å§‹ä¹‹å‰ï¼Œå¦åˆ™dlcä¼šå‡ºç°è¯¯åˆ¤ã€‚

### ç¬¬äºŒæ­¥ï¼šæ ¹æ®ä»£ç è§„åˆ™ä¿®æ”¹`bits.c`ä¸­çš„å‡½æ•°

**é‡è¦æç¤º**ï¼šä¸ºé¿å…è¯„åˆ†æ—¶å‡ºç°æ„å¤–ï¼Œè¯·ç¡®ä¿ä½¿ç”¨`dlc`ç¼–è¯‘å™¨æ£€æŸ¥ä½ çš„è§£å†³æ–¹æ¡ˆæ˜¯å¦éµå¾ªç¼–ç è§„åˆ™ï¼Œå¹¶ä½¿ç”¨`driver.pl`æ­£å¼éªŒè¯ä½ çš„è§£å†³æ–¹æ¡ˆæ˜¯å¦æ­£ç¡®ã€‚

### ä¸€ä¸ªä¾‹å­ï¼š

çœ‹å®Œäº†ä»¥ä¸Šçš„ä¸€äº›å†—é•¿çš„é™åˆ¶ä¹‹åï¼Œä½ å¯èƒ½æ„Ÿå—åˆ°äº†ç–‘æƒ‘ã€‚æ²¡äº‹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†ä»ä¸€ä¸ªå°ä¾‹å­å‡ºå‘ï¼Œæ¥è§£é‡Šè¿™ä¸ªå®éªŒåˆ°åº•éœ€è¦åšäº›ä»€ä¹ˆã€‚

`bits.c`ä¸­çš„æ¯ä¸ªå°çš„è°œé¢˜éƒ½ä¼šæœ‰è°œé¢˜æœ¬èº«çš„é™åˆ¶ï¼Œé™åˆ¶çš„å…·ä½“å†…å®¹å†™åœ¨äº†è°œé¢˜å‡½æ•°ä¸Šé¢çš„æ³¨é‡Šæ ¼å¼ä¸­ã€‚ä¸€ä¸ªå…¸å‹çš„è°œé¢˜ä¾‹å­å¦‚ä¸‹ï¼š

```c
/* 
 * minusOne - return a value of -1 
 *   Legal ops: ! ~ & ^ | + << >>
 *   Max ops: 2
 *   Rating: 1
 */
int minusOne(void) {
  return 1;
}
```

å¦‚ä¸Šé¢˜

- é¢˜åï¼š`minusOne`
- é¢˜ç›®è¦æ±‚ï¼š`return a value of -1` ï¼Œè¿”å›ä¸€ä¸ª`-1`
- åˆæ³•çš„æ“ä½œç¬¦ï¼š`! ~ & ^ | + << >>`
- æœ€å¤šä½¿ç”¨çš„æ“ä½œç¬¦æ•°é‡ï¼š2ä¸ª
- é¢˜ç›®ç­‰çº§ï¼š1æ˜Ÿ

å› æ­¤æˆ‘ä»¬ç¼–å†™å¦‚ä¸‹çš„ç¨‹åºä»£ç ï¼š

```c
int minusOne(void) {
  return ~0;
}
```

å¦‚æœåœ¨ä»£ç ä¸­ä½¿ç”¨äº†éæ³•çš„æ“ä½œç¬¦`-`ï¼Œä¾‹å¦‚ï¼š

```c
int minusOne(void) {
  return -1;
}
```
å°½ç®¡ç»“æœæ­£ç¡®ï¼ˆä½¿ç”¨`btest`æµ‹è¯•æ²¡é—®é¢˜ï¼‰ï¼Œè¿™ä¸ªè°œé¢˜ä»æ˜¯ä¸å¾—åˆ†çš„ã€‚åŒæ ·ï¼Œå¦‚æœåœ¨å‡½æ•°ä¸­ä½¿ç”¨äº†`if for`æˆ–`0xffffffff`ï¼Œä»¥åŠæœ‰ä»»ä½•è§„åˆ™ç¦æ­¢çš„æ“ä½œï¼Œéƒ½æ˜¯ä¸å¾—åˆ†çš„ã€‚

## è°œé¢˜

è¿™ä¸ªå°èŠ‚ç®€è¦åœ°ä»‹ç»äº†ä½ å°†è¦é¢ä¸´çš„å°è°œé¢˜ï¼ŒåŒæ—¶ä½ å¯ä»¥å‚è€ƒè§£å†³ä¸€ä¸ªè°œé¢˜ç”¨åˆ°çš„æ“ä½œç¬¦æ•°é‡~

```text
Correctness Results	Perf Results
Points	Rating	Errors	Points	Ops	Puzzle
8	8	0	2	1	isZero
8	8	0	2	7	bitXor
8	8	0	2	2	copyLSB
8	8	0	2	2	isNegative
8	8	0	2	7	allEvenBits
8	8	0	2	17	byteSwap
8	8	0	2	3	removeRightmostOne
10	10	0	2	10	maskBelowHighest
10	10	0	2	18	largerAbsVal
4	4	0	2	40	bitReverse

Score = 100/100 [80/80 Corr + 20/20 Perf] (107 total operators)
```

ä¸€å…±æœ‰10é“é¢˜ç­‰å¾…ä½ å»è§£å†³ï¼Œè¯·**è¯¦ç»†æ ¸å¯¹è‡ªå·±çš„é¢˜ç›®å’Œä¸Šè¿°é¢˜ç›®æ˜¯å¦æœ‰å‡ºå…¥ï¼Œå¦‚æœ‰å‡ºå…¥ï¼Œè¯·è”ç³»åŠ©æ•™å¤„ç†**ã€‚

## è¯„åˆ†

### æ ‡å‡†è¯„åˆ†æ ‡å‡†

ç»†å¿ƒçš„åŒå­¦å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œåœ¨æ¯ä¸ªè°œé¢˜çš„æè¿°éƒ¨åˆ†ï¼Œè¿˜æœ‰ä¸€è¡Œ`Ratings`ï¼Œè¿™ä»£è¡¨äº†é¢˜ç›®çš„éš¾åº¦ï¼ŒåŒæ—¶ä¹Ÿå†³å®šäº†å¦‚ä½•è¯„åˆ†ã€‚

è°œé¢˜çš„`Ratings`åˆ†ä¸º1æ˜Ÿï¼Œ2æ˜Ÿï¼Œ3æ˜Ÿå’Œ4æ˜Ÿå…±å››ä¸ªç­‰çº§ã€‚å½“ç„¶ï¼Œæ˜Ÿçº§è¶Šé«˜ï¼Œéš¾åº¦è¶Šé«˜ï¼Œä¸åŒæ˜Ÿçº§çš„é¢˜ç›®éš¾åº¦å¯ä»¥æ¦‚æ‹¬ä¸ºï¼š

- 1æ˜Ÿå’Œ2æ˜Ÿé¢˜ï¼Œåªéœ€è¦å¾ˆç®€å•çš„é€»è¾‘å’Œå°‘æ•°å‡ ä¸ªæ“ä½œç¬¦å°±å¯ä»¥å®Œæˆ
- 3æ˜Ÿé¢˜ï¼Œå¢åŠ äº†æ€ç»´éš¾åº¦ï¼Œä½†æ˜¯ä¸éœ€è¦å¤§é‡çš„æ“ä½œç¬¦ï¼ˆå®ç°ç®€å•ï¼‰
- 4æ˜Ÿé¢˜ï¼Œå…·æœ‰æœ€é«˜çš„æ€ç»´éš¾åº¦æˆ–å¤§é‡çš„æ“ä½œç¬¦ï¼ˆå®ç°å¤æ‚ï¼‰

ä¸è¿‡åŒå­¦ä»¬ä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬ä¸ºå¤§å®¶å‡†å¤‡çš„10é“é¢˜ç›®åŒ…å«äº†2é“1æ˜Ÿé¢˜ï¼Œ5é“2æ˜Ÿé¢˜ï¼Œ2é“ä¸‰æ˜Ÿé¢˜å’Œ1é“å››æ˜Ÿé¢˜ï¼Œä¿è¯åŒå­¦ä»¬å¯ä»¥å¾ˆè½»æ¾çš„æ‹¿åˆ°ä¸€ä¸ªåŸºæœ¬åˆ†æ•°ã€‚

ä½ çš„æœ€ç»ˆå¾—åˆ†çš„è®¡ç®—è§„åˆ™å¦‚ä¸‹ï¼ˆå…±100åˆ†ï¼‰ï¼š

- 1æ˜Ÿå’Œ2æ˜Ÿé¢˜ï¼Œæ¯é¢˜8åˆ†
- 3æ˜Ÿé¢˜ï¼Œæ¯é¢˜10åˆ†
- 4æ˜Ÿé¢˜ï¼Œæ¯é¢˜4åˆ†

å› æ­¤ï¼Œ10é“é¢˜çš„æ€»åˆ†æŒ‰ç…§ä¸Šè¿°è§„åˆ™åŠ èµ·æ¥ä¸€å…±80åˆ†ï¼Œå¦‚æœä½ å¯ä»¥é€šè¿‡`btest`çš„æ£€æŸ¥ï¼Œå¹¶ä¸”ä»£ç ç¬¦åˆä¸Šæ–‡æåˆ°çš„ä»£ç è§„åˆ™ï¼ˆå³å¯ä»¥é€šè¿‡`dlc`çš„æ£€æŸ¥ï¼‰ï¼Œä½ å°†å¾—åˆ°åŸºæœ¬çš„80åˆ†ã€‚

åŒæ—¶è°œé¢˜çš„**æœ€å¤§æ“ä½œç¬¦æ•°é‡ä¹Ÿæ˜¯æœ‰é™åˆ¶**çš„ï¼Œå¦‚æœä½ å¯ä»¥å®ç°åœ¨æœ€å¤§æ“ä½œç¬¦æ•°é‡ä¹‹å†…å®Œæˆå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°å¾—2åˆ†ï¼Œå¦‚æœä½ å¯ä»¥ä¿æŒæ­£ç¡®æ€§å¹¶ä¸”æ“ä½œç¬¦æ•°é‡åœ¨æœ€å¤§æ“ä½œç¬¦æ•°é‡ä¹‹å†…ï¼Œä½ å°†è·å¾—å‰©ä½™çš„â€œæ€§èƒ½åˆ†â€20åˆ†ã€‚

### è¿Ÿäº¤
åœ¨è¶…è¿‡åŸå®šçš„æˆªæ­¢æ—¶é—´åï¼Œæˆ‘ä»¬ä»ç„¶æ¥å—åŒå­¦çš„æäº¤ã€‚æ­¤æ—¶ï¼Œåœ¨labä¸­èƒ½è·å¾—çš„æœ€é«˜åˆ†æ•°å°†éšç€è¿Ÿäº¤å¤©æ•°çš„å¢åŠ è€Œå‡å°‘ï¼Œå…·ä½“æœä»ä»¥ä¸‹ç»™åˆ†ç­–ç•¥ï¼š

è¶…æ—¶7å¤©ï¼ˆå«7å¤©ï¼‰ä»¥å†…æ—¶ï¼Œæ¯å¤©æ‰£é™¤3%çš„åˆ†æ•°
è¶…æ—¶7~14å¤©ï¼ˆå«14å¤©ï¼‰æ—¶ï¼Œæ¯å¤©æ‰£é™¤4%çš„åˆ†æ•°
è¶…æ—¶14å¤©ä»¥ä¸Šæ—¶ï¼Œæ¯å¤©æ‰£é™¤7%çš„åˆ†æ•°ï¼Œç›´è‡³æ‰£å®Œ
ä»¥ä¸Šç­–ç•¥ä¸­è¶…æ—¶ä¸è¶³ä¸€å¤©çš„ï¼Œå‡æŒ‰ä¸€å¤©è®¡ï¼Œè‡ªddlæ—¶é—´å¼€å§‹è®¡ç®—ã€‚å±Šæ—¶åœ¨çº¿å­¦ä¹ å¹³å°å°†å¼€æ”¾è¿Ÿäº¤é€šé“ã€‚

è¯„åˆ†æ ·ä¾‹ï¼šå¦‚æŸåŒå­¦å°Håœ¨labä¸­å–å¾—95åˆ†ï¼Œä½†æ™šäº¤3å¤©ï¼Œé‚£ä¹ˆä»–çš„æœ€ç»ˆåˆ†æ•°å°±ä¸º`95*(1-3*3%)=86.45`åˆ†ã€‚åŒæ ·çš„åˆ†æ•°åœ¨æ™šäº¤8å¤©æ—¶ï¼Œæœ€ç»ˆåˆ†æ•°åˆ™ä¸º`95*(1-7*3%-1*4%)=71.25`åˆ†ã€‚

## æœ¬åœ°è‡ªåŠ¨æµ‹è¯•ä½ çš„å·¥ä½œ
ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬ç®€è¦åœ°è°ˆåˆ°äº†ä½ çš„å®éªŒæˆç»©çš„ç»„æˆï¼Œä½ å¯èƒ½æ„Ÿåˆ°äº†æ…Œå¼ ã€‚æˆ‘è¯¥æ€ä¹ˆä¿è¯æˆ‘æœ¬åœ°çš„ç¨‹åºæ˜¯bugfreeçš„å‘¢ï¼Ÿéš¾ä¸æˆè¦æˆ‘è‡ªå·±æ‰‹åŠ¨äººè‚‰æµ‹è¯•å—ï¼ï¼Ÿè¿™æ˜¾ç„¶æ˜¯ä¸€ç§è‹›æ±‚ï¼Œäº‹å®ä¸Šï¼Œæˆ‘ä»¬å°†å®Œæ•´çš„æµ‹è¯•ç¨‹åºåœ¨å®éªŒåˆ†å‘åŒ…ä¸­ç»™äº†ä½ ã€‚

- ä½ å¯ä»¥è‡ªè¡Œä½¿ç”¨æµ‹è¯•ç¨‹åº`btest`å»æµ‹è¯•ä½ çš„ç¨‹åºçš„æ­£ç¡®æ€§ã€‚

- ä¸æ­¤åŒæ—¶ï¼Œä¸ºäº†æµ‹è¯•ä»£ç æ˜¯å¦ç¬¦åˆä»£ç è§„åˆ™ï¼Œæˆ‘ä»¬ç»™å‡ºäº†`dlc`æ–‡ä»¶ï¼Œ`dlc`æ–‡ä»¶å¯ä»¥æµ‹è¯•ä½ çš„ç­”æ¡ˆä¸­æ˜¯å¦ç¬¦åˆä»£ç è§„åˆ™ï¼Œæ˜¯å¦è¶…å‡ºäº†æœ€å¤§æ“ä½œç¬¦æ•°é‡ã€‚

- æœ€åå¯ä»¥ä½¿ç”¨`driver.pl`æ¥æµ‹è¯•ç¨‹åºçš„æœ€ç»ˆå¾—åˆ†ï¼Œ`driver.pl`çš„æµ‹è¯•è¿™æˆ‘ä»¬æœ€ç»ˆæµ‹è¯•ä½ æäº¤ä¸Šæ¥æ–‡ä»¶çš„æ–¹æ³•ä¸€è‡´ï¼Œæ¢å¥è¯è¯´ï¼Œä½ å¦‚æœåœ¨æœ¬åœ°ä½¿ç”¨`driver.pl`æµ‹è¯•å¾—åˆ°äº†æ»¡åˆ†ï¼Œé‚£ä¹ˆä½ åœ¨æœ€ç»ˆçš„è€ƒæ ¸ä¸­ä¹Ÿä¼šå¾—åˆ°ä¸€è‡´çš„åˆ†æ•°ã€‚

- å½“ç„¶å®éªŒä¸­è¿˜æœ‰ä¸¤ä¸ªç¨‹åºå¯ä»¥å¸®åŠ©ä½ å®Œæˆè¿™ä¸ªå®éªŒï¼Œå°±æ˜¯`ishow`å’Œ`fshow`ã€‚

### ä»£ç åŠŸèƒ½æ­£ç¡®æ€§ -> `btest`
å¦‚æœä½ çš„`bits.c`çš„ç¨‹åºç¼–å†™æ»¡è¶³Cè¯­è¨€è¦æ±‚å¹¶å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œåœ¨æœ¬åœ°æ ¹ç›®å½•ä¸‹`make`ä¹‹åä½ å°†ä¼šè·å¾—ï¼š

```bash
linux$ make
```

å¦‚ä¸‹çš„ç›®å½•ï¼š

```bash
linux$ ls
bits.c  bits.h  btest  btest.c  btest.h  decl.c  dlc  Driverlib.pm  driver.pl  fshow  fshow.c  ishow  ishow.c  Makefile  README.md  tests.c
```

å…¶ä¸­`btest`ç¨‹åºé€šè¿‡å¤šæ¬¡è°ƒç”¨å®ƒä»¬æ¥æ£€æŸ¥`bits.c`ä¸­å‡½æ•°çš„æ­£ç¡®æ€§ä¸åŒçš„å‚æ•°å€¼ã€‚è¦æ„å»ºå’Œä½¿ç”¨å®ƒï¼Œè¯·é”®å…¥ä»¥ä¸‹ä¸¤ä¸ªå‘½ä»¤ï¼š

```bash
linux$ make
linux$ ./btest
```

éœ€è¦æ³¨æ„çš„ç¬¬ä¸€ç‚¹æ˜¯ï¼Œä½ **æ¯æ¬¡ä¿®æ”¹ä½ çš„`bits.c`æ–‡ä»¶ä¹‹åï¼Œä½ éœ€è¦é€šè¿‡`make`é‡æ–°`build`ä¹‹åå†è¿›è¡Œæµ‹è¯•**ï¼š

å³å¦‚æœä½ æ–°å®Œæˆäº†ä¸€ä¸ªè°œé¢˜ï¼Œä½ æƒ³è¦é‡æ–°æµ‹è¯•ï¼Œåˆ™éœ€è¦å®Œæˆå¦‚ä¸‹çš„æµç¨‹ï¼š

```bash
linux$ make
linux$ ./btest
```

é€šå¸¸æ¥è¯´ä½ ä¼šè·å¾—å¦‚ä¸‹ç±»å‹çš„è¿è¡Œç»“æœï¼š

```bash
linux$ ./btest
Score	Rating	Errors	Function
 8	8	0	isZero
 8	8	0	bitXor
ERROR: Test copyLSB(-2147483648[0x80000000]) failed...
...Gives 2[0x2]. Should be 0[0x0]
 8	8	0	isNegative
 8	8	0	allEvenBits
 8	8	0	byteSwap
 8	8	0	removeRightmostOne
 10	10	0	maskBelowHighest
 10	10	0	largerAbsVal
 4	4	0	bitReverse
Total points: 72/80
```

å¦‚ä¸Šè¾“å‡ºä¸­å‘Šè¯‰ä½ æ¯ä¸€é¢˜çš„å¾—åˆ†ï¼Œå¦‚æœä½ çš„ç¨‹åºå‡ºé”™ï¼Œåˆ™ä¼šè¾“å‡ºå¯¹åº”çš„å‡ºé”™çš„é¢˜ç›®ä¸å‡ºé”™æ—¶å€™çš„è¾“å…¥å’Œè¾“å‡ºã€‚

å¦‚ä¸Šä¸­ï¼Œ`btest`å‘Šè¯‰æˆ‘ä»¬ï¼š

*Test copyLSB*æµ‹è¯•ç”¨ä¾‹å‡ºå·®é”™
å‡ºé”™çš„è¾“å…¥æ˜¯ï¼š`-2147483648[0x80000000]`
ä½ çš„è¾“å‡ºæ˜¯ï¼š`2[0x2]`
æ­£ç¡®çš„è§£åº”è¯¥æ˜¯`0[0x0]`
æ ¹æ®è¾“å‡ºçš„ç»“æœæˆ‘ä»¬è¿”å›å»ç»§ç»­ä¿®æ”¹æˆ‘ä»¬çš„ä»£ç ã€‚

### ä»£ç è§„åˆ™æ£€æµ‹å·¥å…· -> `dlc`

btestå¹¶ä¸ä¼šå‘Šè¯‰æˆ‘ä»¬å†™çš„ä»£ç æ˜¯ä¸æ˜¯ç¬¦åˆä»£ç è§„åˆ™ï¼Œè¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨`dlc`äº†ã€‚`dlc`çš„ä½¿ç”¨æ–¹æ³•éå¸¸ç®€å•ï¼Œå¦‚ä¸‹ï¼š

```bash
linux$ ./dlc bits.c
```

å¦‚æœä½ çš„ä»£ç éƒ½ç¬¦åˆä»£ç è§„åˆ™ï¼Œé‚£ä¸ä¼šè¾“å‡ºä»»ä½•ç»“æœã€‚

å¦‚æœä½ çš„ä»£ç ä¸­æœ‰ä¸ç¬¦åˆä»£ç è§„åˆ™çš„åœ°æ–¹ï¼Œä¸€ä¸ªå…¸å‹çš„è¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š

```bash
linux$ ./dlc bits.c
dlc:bits.c:202:copyLSB: Illegal if
dlc:bits.c:230:conditional: Illegal constant (0xffffffff) (only 0x0 - 0xff allowed)
dlc:bits.c:245:isPositive: Warning: 10 operators exceeds max of 8
```

å¦‚ä¸Šï¼Œ`dlc`å‘Šè¯‰æˆ‘ä»¬:
åœ¨202è¡Œï¼Œ`copyLSB`å‡½æ•°ä¸­ï¼Œä½¿ç”¨äº†éæ³•çš„`if`ã€‚
åœ¨230è¡Œï¼Œ`conditional`å‡½æ•°ä¸­ï¼Œä½¿ç”¨äº†éæ³•çš„å¸¸é‡`0xffffffff`ã€‚
åœ¨245è¡Œï¼Œ`isPositive`å‡½æ•°ä¸­ï¼Œä½¿ç”¨äº†`10`ä¸ªæ“ä½œç¬¦ï¼Œè¶…è¿‡äº†`Maxops=8`ä¸ªã€‚

æ ¹æ®è¾“å‡ºçš„ç»“æœæˆ‘ä»¬è¿”å›å»ç»§ç»­ä¿®æ”¹æˆ‘ä»¬çš„ä»£ç ã€‚

`dlc`åŒæ—¶è¿˜æœ‰å¾ˆå¤šåŠŸèƒ½ï¼Œä¾‹å¦‚`./dlc -e bits.c`ç­‰ï¼Œä½ å¯ä»¥é€šè¿‡`./dlc -h`è¾“å‡ºçš„å¸®åŠ©ä¿¡æ¯å»è‡ªè¡Œäº†è§£ã€‚

### å®éªŒæœ€ç»ˆå¾—åˆ†å·¥å…· -> `driver.pl`

ä¸ºäº†è®¡ç®—å‡ºè‡ªå·±çš„æœ€ç»ˆåˆ†æ•°ï¼Œæˆ‘ä»¬æä¾›äº†`driver.pl`æ¥è®¡ç®—ã€‚

`driver.pl`çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š

```bash
linux$ ./driver.pl
```

ä¸€ä¸ªå…¸å‹çš„ç»“æœå¦‚ä¸‹ï¼š
```bash
linux$ ./driver.pl
1. Running './dlc -z' to identify coding rules violations.

2. Compiling and running './btest -g' to determine correctness score.
gcc -O1 -g -Wall   -lm -o btest bits.c btest.c decl.c tests.c 

3. Running './dlc -Z' to identify operator count violations.

4. Compiling and running './btest -g -r 2' to determine performance score.
gcc -O1 -g -Wall   -lm -o btest bits.c btest.c decl.c tests.c 

5. Running './dlc -e' to get operator count of each function.

Correctness Results	Perf Results
Points	Rating	Errors	Points	Ops	Puzzle
8	8	0	2	1	isZero
8	8	0	2	7	bitXor
0	8	1	0	0	copyLSB
8	8	0	2	2	isNegative
8	8	0	2	7	allEvenBits
8	8	0	2	17	byteSwap
8	8	0	2	3	removeRightmostOne
10	10	0	2	10	maskBelowHighest
10	10	0	2	18	largerAbsVal
4	4	0	2	40	bitReverse

Score = 90/100 [72/80 Corr + 18/20 Perf] (105 total operators)

```
å¯ä»¥çœ‹åˆ°ï¼Œæœ€ç»ˆå¾—äº†90åˆ†ï¼Œå…¶ä¸­`copyLSB`å‡½æ•°ç”±äºä¸ç¬¦åˆä»£ç è§„åˆ™ï¼Œä¸å¾—åˆ†ã€‚

### è¿›åˆ¶è½¬æ¢å·¥å…·

åœ¨é¢˜ç›®ç¼–å†™è¿‡ç¨‹ä¸­ï¼Œæ‚¨å¯èƒ½éœ€è¦ä¸€äº›å·¥å…·çš„å¸®åŠ©æ¥ç¡®å®šä¸€äº›10è¿›åˆ¶æ•°çš„16è¿›åˆ¶æ ¼å¼ã€‚

æˆ‘ä»¬ä¸ºæ‚¨æä¾›äº†ç›¸åº”çš„ä¾¿æ·å·¥å…·`ishow`ã€`fshow`ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æä¾›çš„ç¨‹åº `ishow `æŸ¥çœ‹æ•´æ•°çš„åè¿›åˆ¶å’Œåå…­è¿›åˆ¶è¡¨ç¤ºå½¢å¼ã€‚é¦–å…ˆç¼–è¯‘ä»£ç å¦‚ä¸‹ï¼š

```bash
linux$ make
```

ç„¶åä½¿ç”¨å®ƒæ¥æ£€æŸ¥åœ¨å‘½ä»¤è¡Œä¸­é”®å…¥çš„åå…­è¿›åˆ¶å’Œåè¿›åˆ¶å€¼ï¼š

```bash
linux$  ./ishow 0x80000000
Hex = 0x80000000,       Signed = -2147483648,   Unsigned = 2147483648
linux$  ./ishow -1
Hex = 0xffffffff,       Signed = -1,    Unsigned = 4294967295
```
å®ƒä¼šå¸®åŠ©ä½ å®Œæˆè¿›åˆ¶çš„è½¬æ¢ã€‚

åŒç†æˆ‘ä»¬è¿˜æä¾›äº†`fshow`å·¥å…·ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°çš„è½¬æ¢å™¨ï¼Œä½†æ˜¯è¿™æ¬¡çš„å®éªŒæ²¡æœ‰æ¶‰åŠï¼Œæ‰€ä»¥ä¸åšè¦æ±‚ï¼Œå¤§å®¶æœ‰å…´è¶£å¯ä»¥è‡ªè¡Œå°è¯•ï¼Œä½¿ç”¨æ–¹æ³•ä¸`ishow`ç±»ä¼¼ã€‚


## ä»£ç æäº¤

åœ¨`datalab-sp25` ç›®å½•ä¸‹æ‰§è¡Œ`make submit`

```bash
linux$ make submit
```

ç›®å½•ä¸‹éƒ½ä¼šç”Ÿæˆä¸€ä¸ªåä¸º `<userid>-handin.zip `çš„æ–‡ä»¶ï¼ˆå…¶ä¸­ `<userid> `ä¸º`Linux`ç³»ç»Ÿä¸­ä½ çš„ç”¨æˆ·åï¼‰ã€‚ï¼ˆæ¯æ¬¡ä¿®æ”¹ä»£ç åï¼Œè®°ç€è¦é‡æ–°è¿è¡Œ`make submit`ï¼‰

åœ¨[åœ¨çº¿å­¦ä¹ å¹³å°](http://class.xjtu.edu.cn/)ä¸Šçš„ä½œä¸šæ¨¡å—ä¸­ï¼Œå°†è¯¥æ–‡ä»¶ä½œä¸ºé™„ä»¶æäº¤å³å¯ã€‚

## ä¸€äº›å°çš„å»ºè®®

- Start Early
- è°œé¢˜å¯èƒ½æ¯”è¾ƒå¤æ‚ï¼Œå¯èƒ½ä¸€æ—¶é—´ä¸å¯ä»¥ç›´æ¥æƒ³å‡ºä¼˜ç§€çš„æ»¡è¶³è¦æ±‚çš„è§£æ³•ï¼Œä½†æ˜¯ä¸è¦æ°”é¦ï¼Œæ²¡æœ‰äººå¯ä»¥é©¬ä¸Šç»™å‡ºæœ€ä¼˜çš„è§£æ³•ã€‚ä¸€ä¸ªæ¯”è¾ƒå¥½çš„è§£é¢˜å°è¯•è·¯å¾„æ˜¯ï¼š
  - å…ˆå°è¯•åœ¨çº¸ä¸Šå†™å‡ºä¸€èˆ¬çš„è§£æ³•
  - ä»ä¸€èˆ¬è§£ä¸­æ‰¾å‡ºæ›´ä¸€èˆ¬æ€§çš„è§„å¾‹ï¼Œè¿™äº›è§„å¾‹å¯èƒ½é€šå¸¸éœ€è¦ä½ çš„çµå…‰ä¸€ç°ï¼Œä½†æ˜¯å¯¹ç›¸ä¿¡èªæ˜çš„ä½ æ¥è¯´è¿™ä¸æ˜¯é—®é¢˜ã€‚
- å¦‚æœæ‚¨æ˜¯é‡‡ç”¨è‡ªå·±æœ¬åœ°çš„ç¯å¢ƒï¼Œé‚£ä¹ˆæ€»ä¼šå‡ºç°ä¸€äº›ä¾èµ–ç¼ºå¤±ï¼Œè½¯ä»¶æœªå®‰è£…ç­‰ç­‰ä¹‹ç±»çš„é”™è¯¯ã€‚è¯·å¤§å®¶ä¸è¦æ…Œå¼ ï¼Œä¸€ä¸ªå¥½çš„ç¨‹åºå‘˜éœ€è¦æ›´å¥½çš„äº†è§£è‡ªå·±æ‰‹é‡Œçš„å·¥å…·ï¼Œè€Œè‡ªå·±æ­å»ºç¯å¢ƒå¾€å¾€å°±æ˜¯å…¶ä¸­å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œè¯·å¤§å®¶è‡ªè¡ŒæŸ¥è¯¢ç›¸å…³ç¯å¢ƒé—®é¢˜ï¼Œè‡ªå·±åŠ¨æ‰‹è§£å†³é—®é¢˜ï¼ˆæŠ˜è…¾ï¼ˆç¬‘ï¼‰ï¼‰çš„èƒ½åŠ›åœ¨è®¡ç®—æœºä¸“ä¸šçš„å­¦ä¹ ä¸­æ˜¯éå¸¸é‡è¦çš„ã€‚
- æ‰¾åˆ°é€‚åˆè‡ªå·±çš„å¥½å·¥å…·çš„èƒ½åŠ›ï¼šè¯·å¤§å®¶åœ¨ä¸æ–­åœ°åŠ¨æ‰‹ä¸­å­¦ä¹ å¹¶æ‰¾åˆ°é€‚åˆè‡ªå·±çš„å·¥å…·ï¼Œä»¥æé«˜è‡ªå·±çš„æ•ˆç‡ã€‚

æœ€åç¥å¤§å®¶ç©çš„æ„‰å¿«ã€‚

---

Copyright Â© 2025 XJTU ICS-TEAM

